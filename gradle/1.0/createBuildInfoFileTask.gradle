ext.build = new Date().format('yyyy-MM-dd HH:mm:ss S')
version = new ProjectVersion(version, System.env.SOURCE_BUILD_NUMBER)
class ProjectVersion {
	String version
	String build
	
	ProjectVersion(String version, String build) {
		this.version = version
		this.build = build
	}
	@Override
	String toString() {
		String version = version
		if(build) {
			version += ".$build"
		}
		version
	}
}

task createBuildInfoFile << {
	def buildInfoFile = new File("$buildDir/version.txt")
	Properties properties = new Properties()
	properties.setProperty('project-name', project.name)
	properties.setProperty('project-version', project.version.toString())
	properties.setProperty('project-build', build)
	properties.store(buildInfoFile.newWriter(), null)
}