ext.version = new Version(project.version, System.env.SOURCE_BUILD_NUMBER)
class Version {
	String version
	String build
	
	Version(String version, String build) {
		this.version = version
		this.build = build
	}
	@Override
	String toString() {
		if(build) {
			version += ".$build"
		}
		version
	}
}

task createVersionText << {
	def buildInfoFile = new File("$buildDir/version.txt")
	Properties properties = new Properties()
	properties.setProperty('project-name', project.name)
	properties.setProperty('project-version', version.toString())
	properties.setProperty('project-date', new Date().format('yyyy-MM-dd HH:mm:ss S'))
	properties.store(buildInfoFile.newWriter(), null)
}